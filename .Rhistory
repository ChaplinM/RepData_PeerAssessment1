activity = read.csv("activity/activity.csv", header=T)
summary(steps)
summary(activity$steps)
summary(activity)
str(activity)
tail(activity,10)
class(activity)
activity$CalDay = as.Date(activity$date, format="Y-m-d")
summary(acivity$CalDay)
summary(activity$CalDay)
activity = read.table("activity/activity.csv", sep=",", header=T)
class(activity)
library(data.table)
#activity = read.csv("activity/activity.csv", header=T)
activity = read.table("activity/activity.csv", sep=",", header=T)
class(activity)
activity$CalDay = as.Date(activity$date, format="Y-m-d")
summary(activity$CalDay)
as.Date("2012-10-01", format="Y-m-d")
help(as.Date)
activity[1,"date"]
as.Date(activity[1,"date"],format="%Y-%m-%d")
activity$CalDay = as.Date(activity$date, format="%Y-%m-%d")
aggregate(activity$steps, activity$CalDay, sum, na.omit=T)
aggregate(activity$steps, activity$CalDay, sum, na.omit=T)
aggregate(activity[,"steps"], activity[,"CalDay"], sum, na.omit=T)
help(aggregate)
aggregate(activity$steps, list(activity$CalDay), sum, na.omit=T)
subset(activity, CalDay=="2012-11-15")
aggregate(activity$steps, list(activity$CalDay), sum, na.omit)
aggregate(activity$steps, list(activity$CalDay), sum, na.action=na.omit)
aggregate(activity$steps, list(activity$CalDay), sum, na.action=na.omit)
aggregate(activity$steps, list(activity$CalDay), sum, na.action="na.omit")
aggregate(activity$steps, list(activity$CalDay), sum, na.action = na.omit)
aggregate(x=activity$steps, by=list(activity$CalDay), FUN=sum, na.action = na.omit)
aggregate(x=activity$steps, by=list(activity$CalDay), FUN=sum)
aggregate(x=activity$steps, by=list(activity$CalDay), FUN=sum, na.action = na.ignore)
help(na.omit)
actSteps  <- subset(activity, select=steps)
actCalDay <- subset(activity, select=CalDay)
#aggregate(activity$steps, activity$CalDay, sum, na.omit=T)
aggregate(actSteps, actCalDay, sum)
actDailySteps <- aggregate(actSteps, actCalDay, sum)
hist(actDailySteps)
hist(actDailySteps$steps)
hist(actDailySteps$steps, col="lightblue")
abline(v = median(actDailySteps$steps), col = "blue", lwd = 4)
abline(v = mean(actDailySteps$steps), col = "red", lty=2, lwd=4)
hist(actDailySteps$steps, col="paleyellow")
abline(v = median(actDailySteps$steps, na.rm=T), col = "blue", lwd = 4)
abline(v = mean(actDailySteps$steps, na.rm=T), col = "red", lty=2, lwd=4)
median(actDailySteps$steps, na.rm=T)
mean(actDailySteps$steps, na.rm=T)
hist(actDailySteps$steps, col="lightyellow")
abline(v = median(actDailySteps$steps, na.rm=T), col = "blue", lwd = 4)
abline(v = mean(actDailySteps$steps, na.rm=T), col = "red", lty=2, lwd=4)
quantile(actDailySteps$steps, probs=c(0.5))
quantile(actDailySteps$steps, probs=c(0.5), na.rm=T)
quantile(actDailySteps$steps, probs=c(0.25), na.rm=T)
quantile(actDailySteps$steps, probs=c(0.75), na.rm=T)
head(activity$interval, 25)
actInterval <- subset(activity, select=interval)
#aggregate(activity$steps, activity$CalDay, sum, na.omit=T)
actIntervalSteps <- aggregate(actSteps, actInterval, mean)
plot(actIntervalSteps$steps ~ actIntervalSteps$interval, type="l", xlab="Hours and minutes",
ylab="Mean interval steps")
actIntervalSteps <- aggregate(actSteps, actInterval, mean, na.action=na.omit)
actDailySteps
subset(activity, date="2012-10-01")
subset(activity, $date=="2012-10-01")
subset(activity, date=="2012-10-01")
subset(activity, date=="2012-10-08")
subset(activity, date=="2012-11-01")
subset(activity, interval==0)
61 * 24 * 12
subset(activity, interval==5)
subset(activity, interval==10)
subset(activity, interval==15)
subset(activity, interval==20)
subset(activity, interval==25)
actIntervalSteps <- aggregate(actSteps, actInterval, mean, na.rm=T)
91/53
18/53
7/53
8/53
4/53
View(actIntervalSteps)
111/53
plot(actIntervalSteps$steps ~ actIntervalSteps$interval, type="l", xlab="Hours and minutes",
ylab="Mean interval steps")
which.max(actIntervalSteps)
which.max(actIntervalSteps$steps)
max(actIntervalSteps$steps)
actIntervalSteps[max(actIntervalSteps$steps),"interval"]
actIntervalSteps[which.max(actIntervalSteps$steps),"interval"]
example(sprintf)
sprintf("Time is %4i", 0)
sprintf("Time is %4d", 0)
sprintf("Time is %04d", 0)
sprintf("Time is %04d", 105)
sprintf("Time is %04d", 55)
maxVal = max(actIntervalSteps$steps)
maxVal
maxAt = actIntervalSteps[which.max(actIntervalSteps$steps),"interval"]
maxAt
maxZeroPad = sprintf("%04d", maxAt)
max24h = paste(substr(maxZeroPad,1,2),maxZeroPad(3,4),"h")
max24h
max24h = paste(substr(maxZeroPad,1,2),substr(maxZeroPad,3,4),"h")
max24h
substr(maxZeroPad,1,2)
help(paste)
max24h = paste(substr(maxZeroPad,1,2),substr(maxZeroPad,3,4),sep="h")
max24h
actIntervalSteps[which.min(actIntervalSteps$steps),"interval"]
head(actIntervalSteps, 50)
subset(actIntervalSteps, steps>206.1698)
subset(actIntervalSteps, steps>206)
subset(actIntervalSteps, steps>200)
subset(actIntervalSteps, steps>150)
subset(actIntervalSteps, steps>maxVal-0.001)
impMeanSteps <- cbind(actIntervalSteps$interval, meanSteps=actIntervalSteps$steps)
View(impMeanSteps)
View(impMeanSteps)
impMeanSteps <- cbind(interval=actIntervalSteps$interval, meanSteps=actIntervalSteps$steps)
impMeanSteps <- data.frame()
impMeanSteps <- cbind(impMeanSteps, interval=actIntervalSteps$interval, meanSteps=actIntervalSteps$steps)
impMeanSteps <- data.frame(interval=actIntervalSteps$interval, meanSteps=actIntervalSteps$steps)
impActivity <- merge(x=activity,y=impMeanSteps,by.x=activity$interval,by.y=impMeanSteps$interval,all=F)
help(merge)
impActivity <- merge(x=activity,y=impMeanSteps,by.x="interval",by.y="interval",all=F)
head(impActivity, 10)
impActivity$steps <- ifelse(is.na(impActivity$steps), impActivity$meanSteps, impActivity$steps)
View(impActivity)
impDailySteps <- aggregate(steps=list(impActivity$steps), CalDay=list(impActivity$CalDay), sum)
impDailySteps <- aggregate(steps=impActivity$steps, CalDay=list(impActivity$CalDay), sum)
impDailySteps <- aggregate(impSteps, impCalDay, sum)
impSteps  <- subset(impActivity, select=steps)
impCalDay <- subset(impActivity, select=CalDay)
impDailySteps <- aggregate(impSteps, impCalDay, sum)
View(impDailySteps)
View(actDailySteps)
View(impDailySteps)
hist(impDailySteps$steps, col="lightyellow")
abline(v = median(impDailySteps$steps, na.rm=T), col = "blue", lwd = 4)
abline(v = mean(impDailySteps$steps, na.rm=T), col = "red", lty=2, lwd=4)
window()
windows()
par(mfrow = c(2,1))
hist(actDailySteps$steps, col="lightyellow")
abline(v = median(actDailySteps$steps, na.rm=T), col = "blue", lwd = 4)
abline(v = mean(actDailySteps$steps, na.rm=T), col = "red", lty=2, lwd=4)
hist(impDailySteps$steps, col="lightyellow")
abline(v = median(impDailySteps$steps, na.rm=T), col = "blue", lwd = 4)
abline(v = mean(impDailySteps$steps, na.rm=T), col = "red", lty=2, lwd=4)
par(mfrow = c(1,1))
combDailySteps = data.frame(CalDay=as.date(NULL),steps=as.integer(NULL),type=as.character(NULL))
combDailySteps = data.frame(CalDay=as.Date(NULL),steps=as.integer(NULL),type=as.character(NULL))
combDailySteps = data.frame(CalDay=as.Date(),steps=as.integer(),type=as.character())
combDailySteps = data.frame(CalDay=as.Date(NA),steps=as.integer(NA),type=as.character(NA))
View(combDailySteps)
combDailySteps = data.frame(CalDay=as.Date(0),steps=as.integer(0),type=as.character(0))
combDailySteps = data.frame(CalDay=Date(0),steps=integer(0),type=character(0))
combDailySteps = data.frame(CalDay=as.Date(character()),steps=integer(),type=character())
combDailySteps = data.frame(CalDay=as.Date(character()),steps=integer(),type=character(),stringsAsFactors=F)
combDailySteps = rbind(combDailySteps, actDailySteps$CalDay, actDailySteps$steps, "Missing")
View(combDailySteps)
combDailySteps = data.frame(CalDay=as.Date(character()),steps=integer(),type=character(),stringsAsFactors=F)
combDailySteps = rbind(combDailySteps, list(actDailySteps$CalDay, actDailySteps$steps, "Missing"))
combDailySteps = rbind(combDailySteps, c(actDailySteps$CalDay, actDailySteps$steps, "Missing"))
combDailySteps = data.frame(CalDay=as.Date(character()),steps=integer(),type=character(),stringsAsFactors=F)
combDailySteps = rbind(combDailySteps, list(actDailySteps$CalDay, actDailySteps$steps, rep("Missing",288))
View(combDailySteps)
help(join)
help(union)
actDailySteps$type = "Missing"
impDailySteps$type = "Imputed"
combDailySteps <- rbind(combDailySteps, actDailySteps, impDailySteps)
View(combDailySteps)
combDailySteps <- transform(combDailySteps, type = factor(type))
histogram(combDailySteps$steps | combDailySteps$type, layout = c(2, 1))
library(lattice)
histogram(combDailySteps$steps | combDailySteps$type, layout = c(2, 1))
qplot(steps, data=combDailySteps$steps, facets=.~type)
library("ggplot2", lib.loc="C:/Program Files/R/R-3.0.2/library")
detach("package:lattice", unload=TRUE)
qplot(steps, data=combDailySteps$steps, facets=.~type)
qplot(steps, data=combDailySteps, facets=.~type)
qplot(steps, data=combDailySteps, facets=.~type, binwidth=2500)
weekdays
impDailySteps$weekday <- weekdays(impDailySteps$CalDay)
impDailySteps$weekdayStatus <- ifelse(substr(impDailySteps$weekday,1,1) == "S", 0, 1)
help(aggregate)
impActivity$weekday <- weekdays(impActivity$CalDay)
impActivity$weekdayStatus <- ifelse(substr(impActivity$weekday,1,1) == "S", 0, 1)
impWeekdayStatusMeanSteps <- aggregate(impActivity$steps ~ impActivity$interval + impActivity$weekdayStatus, mean)
impWeekdayStatusMeanSteps <- aggregate(steps ~ interval + weekdayStatus, data=impActivity, mean)
xyplot(steps ~ interval | weekdayStatus, data=impWeekdayStatusMeanSteps, layout = c(1, 2))
library("lattice", lib.loc="C:/Program Files/R/R-3.0.2/library")
xyplot(steps ~ interval | weekdayStatus, data=impWeekdayStatusMeanSteps, layout = c(1, 2))
help(xyplot)
xyplot(steps ~ interval | weekdayStatus, data=impWeekdayStatusMeanSteps,
layout = c(1, 2), type="l")
impWeekdayStatusMeanSteps <- transform(impWeekdayStatusMeanSteps, weekdayStatus = factor(weekdayStatus, labels = c("Weekend", "Weekday")))
xyplot(steps ~ interval | weekdayStatus, data=impWeekdayStatusMeanSteps,
layout = c(1, 2), type="l")
View(impWeekdayStatusMeanSteps)
impWeekdayStatusMeanSteps <- NULL
impActivity$weekdayStatus <- NULL
impActivity$weekendStatus <- ifelse(substr(impActivity$weekday,1,1) == "S", 1, 0)
impWEStatusMean <- aggregate(steps ~ interval + weekendStatus,
data=impActivity, mean)
impWEStatusMean <- transform(impWEStatusMean,
weekendStatus = factor(weekendStatus,
labels = c("Weekday", "Weekend")))
View(impWEStatusMean)
xyplot(steps ~ interval | weekendStatus, data=impWEStatusMean,
layout = c(1, 2), type="l")
View(impActivity)
subset(activity, interval==600)
length(is.na(activity$steps))
length(which(activity$steps))
length(which(is.na(activity$steps)))
library(lattice)
xyplot(steps ~ interval | weekendStatus, data=impWEStatusMean,
layout = c(1, 2), type="l")
View(impDailySteps)
